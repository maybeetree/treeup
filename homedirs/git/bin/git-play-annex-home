#!/bin/sh

if ( realpath "$(which realpath)" | grep busybox )
then
	if ! command -v "coreutils"
	then
		echo "Need coreutils!"
		exit 1
	fi
	alias realpath='coreutils --coreutils-prog=realpath'
fi

hostname="$(hostname)"
remote="$1"
#path="$(realpath "$PWD")"
path="$(realpath "$PWD" --relative-to "$HOME")"

echo "foo..."

if [ -z "$remote" ]
then
	echo "no remote, use bbox.home?"
	read n
	remote=bbox.home
fi

#git status | grep 'working tree clean' || exit 1


#ssh bbox.home -C 'rm -rf "'"$path"'"; mkdir -p "'"$path"'"; cd "'"$path"'"; git init'
echo "SSHing..."
ssh "$remote" -C 'if [ ! -d "$HOME/'"$path"'/.git" ]; then mkdir -p "$HOME/'"$path"'"; cd "'"$path"'"; git init; fi'
git remote add "$remote" "ssh://$remote/~/$path"


